<svg viewBox="0 0 1000 800" xmlns="http://www.w3.org/2000/svg">
  <!-- 標題 -->
  <text x="500" y="30" text-anchor="middle" font-size="24" font-weight="bold">改進的 MVP 架構</text>
  
  <!-- View 層 -->
  <g id="view-layer">
    <rect x="50" y="70" width="900" height="120" fill="#e8f5e9" stroke="#4caf50" stroke-width="2" rx="10"/>
    <text x="500" y="100" text-anchor="middle" font-size="20" font-weight="bold">View Layer</text>
    
    <rect x="80" y="120" width="160" height="50" fill="#a5d6a7" stroke="#4caf50" stroke-width="1" rx="5"/>
    <text x="160" y="150" text-anchor="middle" font-size="14">MainWindow</text>
    
    <rect x="260" y="120" width="160" height="50" fill="#a5d6a7" stroke="#4caf50" stroke-width="1" rx="5"/>
    <text x="340" y="150" text-anchor="middle" font-size="14">CameraPanel</text>
    
    <rect x="440" y="120" width="160" height="50" fill="#a5d6a7" stroke="#4caf50" stroke-width="1" rx="5"/>
    <text x="520" y="150" text-anchor="middle" font-size="14">StatusPanel</text>
    
    <rect x="620" y="120" width="160" height="50" fill="#a5d6a7" stroke="#4caf50" stroke-width="1" rx="5"/>
    <text x="700" y="150" text-anchor="middle" font-size="14">ImageViewer</text>
    
    <rect x="800" y="120" width="120" height="50" fill="#a5d6a7" stroke="#4caf50" stroke-width="1" rx="5"/>
    <text x="860" y="150" text-anchor="middle" font-size="14">InfoPanel</text>
  </g>
  
  <!-- Presenter 層 -->
  <g id="presenter-layer">
    <rect x="50" y="220" width="900" height="150" fill="#fff3e0" stroke="#ff9800" stroke-width="2" rx="10"/>
    <text x="500" y="250" text-anchor="middle" font-size="20" font-weight="bold">Presenter Layer</text>
    
    <rect x="80" y="270" width="160" height="50" fill="#ffcc80" stroke="#ff9800" stroke-width="1" rx="5"/>
    <text x="160" y="300" text-anchor="middle" font-size="14">MainPresenter</text>
    
    <rect x="260" y="270" width="160" height="50" fill="#ffcc80" stroke="#ff9800" stroke-width="1" rx="5"/>
    <text x="340" y="300" text-anchor="middle" font-size="14">CameraPresenter</text>
    
    <rect x="440" y="270" width="160" height="50" fill="#ffcc80" stroke="#ff9800" stroke-width="1" rx="5"/>
    <text x="520" y="300" text-anchor="middle" font-size="14">RecordingPresenter</text>
    
    <rect x="620" y="270" width="160" height="50" fill="#ffcc80" stroke="#ff9800" stroke-width="1" rx="5"/>
    <text x="700" y="300" text-anchor="middle" font-size="14">StatusPresenter</text>
    
    <rect x="800" y="270" width="120" height="50" fill="#ffcc80" stroke="#ff9800" stroke-width="1" rx="5"/>
    <text x="860" y="300" text-anchor="middle" font-size="14">BasePresenter</text>
  </g>
  
  <!-- Interactor 層 -->
  <g id="interactor-layer">
    <rect x="50" y="400" width="900" height="120" fill="#e3f2fd" stroke="#2196f3" stroke-width="2" rx="10"/>
    <text x="500" y="430" text-anchor="middle" font-size="20" font-weight="bold">Interactor Layer (Business Logic)</text>
    
    <rect x="200" y="450" width="160" height="50" fill="#90caf9" stroke="#2196f3" stroke-width="1" rx="5"/>
    <text x="280" y="480" text-anchor="middle" font-size="14">CameraInteractor</text>
    
    <rect x="420" y="450" width="160" height="50" fill="#90caf9" stroke="#2196f3" stroke-width="1" rx="5"/>
    <text x="500" y="480" text-anchor="middle" font-size="14">RecordingInteractor</text>
    
    <rect x="640" y="450" width="160" height="50" fill="#90caf9" stroke="#2196f3" stroke-width="1" rx="5"/>
    <text x="720" y="480" text-anchor="middle" font-size="14">StatusInteractor</text>
  </g>
  
  <!-- Model 層 -->
  <g id="model-layer">
    <rect x="50" y="550" width="900" height="120" fill="#fce4ec" stroke="#e91e63" stroke-width="2" rx="10"/>
    <text x="500" y="580" text-anchor="middle" font-size="20" font-weight="bold">Model Layer</text>
    
    <rect x="200" y="600" width="160" height="50" fill="#f8bbd0" stroke="#e91e63" stroke-width="1" rx="5"/>
    <text x="280" y="630" text-anchor="middle" font-size="14">CameraDevice</text>
    
    <rect x="420" y="600" width="160" height="50" fill="#f8bbd0" stroke="#e91e63" stroke-width="1" rx="5"/>
    <text x="500" y="630" text-anchor="middle" font-size="14">VideoRecorder</text>
    
    <rect x="640" y="600" width="160" height="50" fill="#f8bbd0" stroke="#e91e63" stroke-width="1" rx="5"/>
    <text x="720" y="630" text-anchor="middle" font-size="14">Interfaces</text>
  </g>
  
  <!-- Event Bus -->
  <g id="event-bus">
    <rect x="50" y="700" width="300" height="80" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2" rx="10"/>
    <text x="200" y="730" text-anchor="middle" font-size="18" font-weight="bold">Event Bus</text>
    <text x="200" y="755" text-anchor="middle" font-size="14">統一的事件通訊機制</text>
  </g>
  
  <!-- Common/Utilities -->
  <g id="common">
    <rect x="400" y="700" width="300" height="80" fill="#e0f2f1" stroke="#009688" stroke-width="2" rx="10"/>
    <text x="550" y="730" text-anchor="middle" font-size="18" font-weight="bold">Common</text>
    <text x="550" y="755" text-anchor="middle" font-size="14">Events, Exceptions, Utils</text>
  </g>
  
  <!-- 連接線 -->
  <!-- View to Presenter -->
  <line x1="160" y1="170" x2="160" y2="270" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>
  <line x1="340" y1="170" x2="340" y2="270" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>
  <line x1="520" y1="170" x2="700" y2="270" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>
  <line x1="700" y1="170" x2="340" y2="270" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <!-- Presenter to Interactor -->
  <line x1="340" y1="320" x2="280" y2="450" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>
  <line x1="520" y1="320" x2="500" y2="450" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>
  <line x1="700" y1="320" x2="720" y2="450" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <!-- Interactor to Model -->
  <line x1="280" y1="500" x2="280" y2="600" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>
  <line x1="500" y1="500" x2="500" y2="600" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <!-- Event Bus connections -->
  <path d="M 200 700 Q 200 650 280 650 Q 360 650 360 350" stroke="#9c27b0" stroke-width="2" fill="none" stroke-dasharray="5,5"/>
  
  <!-- 箭頭定義 -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#666"/>
    </marker>
  </defs>
</svg>